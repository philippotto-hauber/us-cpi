ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(color = category, size = weight)+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2)
View(df_plot)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(color = category, size = weight)+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(color = category, size = weight)+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 4,
nudge_x = 1,
nudge_y = 1)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 1,
nudge_y = 1)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.21,
nudge_y = 0.21)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
View(df_plot)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
#ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(
diff_apr21 = round(growth_rate(value, year, month, 2020, 2, 2021, 4), digits = 2),
mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
arrange(desc(mm_apr21)) %>%
select(name, mm_apr21, diff_apr21, weight, category) %>%
head(20) -> df_plot
df_plot
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
#ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
ggsave(filename = "plot_cpi_US.pdf", width = 10, height = 10, units = "in")
ggsave(filename = "plot_cpi_US.pdf", width = 10, height = 8, units = "in")
?ggsave
ggsave(filename = "plot_cpi_US.pdf", width = 15, height = 10, units = "in")
ggsave(filename = "plot_cpi_US.pdf", width = 8, height = 6, units = "in")
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(title = "Vereinigte Staaten: Verbraucherpreisindex",
subtitle = "20 Güter mit der höchsten Monatsrate im April 2021",
caption = "Quelle: Bureau of Labor Statistics, eigene Berechnungen.",
y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
ggsave(filename = "plot_cpi_US.pdf", width = 12, height = 6, units = "in")
df %>%
#filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
filter(level %in% c(4, 5, 6, 7, 8)) %>%
group_by(name, weight, category) %>%
summarise(
diff_apr21 = round(growth_rate(value, year, month, 2020, 2, 2021, 4), digits = 2),
mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
arrange(desc(mm_apr21)) %>%
select(name, mm_apr21, diff_apr21, weight, category) %>%
head(20) -> df_plot
df_plot
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(title = "Vereinigte Staaten: Verbraucherpreisindex",
subtitle = "20 Güter mit der höchsten Monatsrate im April 2021",
caption = "Quelle: Bureau of Labor Statistics, eigene Berechnungen.",
y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(title = "Vereinigte Staaten: Verbraucherpreisindex",
subtitle = "20 Waren und Dienstleistungen (ohne Energie und Lebensmittel) mit der höchsten Monatsrate im April 2021",
caption = "Quelle: Bureau of Labor Statistics, eigene Berechnungen.",
y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 2,
nudge_x = 0.4,
nudge_y = 0.4)
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(title = "Vereinigte Staaten: Verbraucherpreisindex",
subtitle = "20 Waren und Dienstleistungen (ohne Energie und Lebensmittel) mit der höchsten Monatsrate im April 2021",
caption = "Quelle: Bureau of Labor Statistics, eigene Berechnungen.",
y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 4,
nudge_x = 0.4,
nudge_y = 0.4)
ggsave(filename = "plot_cpi_US.pdf", width = 12, height = 6, units = "in")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(
diff_apr21 = round(growth_rate(value, year, month, 2020, 2, 2021, 4), digits = 2),
mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
arrange(desc(mm_apr21)) %>%
select(name, mm_apr21, diff_apr21, weight, category) %>%
head(20) -> df_plot
df_plot
ggplot(df_plot, aes(x = diff_apr21, y = mm_apr21))+
geom_point(aes(color = category, size = weight))+
scale_color_jco()+
ylim(c(0, 18))+
scale_size(breaks = c(0.1, 0.5, 2), labels = c("0.1%", "0.5%", "2%"))+
labs(title = "Vereinigte Staaten: Verbraucherpreisindex",
subtitle = "20 Waren und Dienstleistungen (ohne Energie und Lebensmittel) mit der höchsten Monatsrate im April 2021",
caption = "Quelle: Bureau of Labor Statistics, eigene Berechnungen.",
y="Veränderung April 2021 ggü. März 2021",
x = "Veränderung April 2021 ggü. Februar 2020")+
geom_vline(xintercept = 0)+
geom_text(mapping = aes(x = diff_apr21, y = mm_apr21, label = name),
data = filter(df_plot, name %in% c("Car and truck rental",
"Airline fares",
"Used cars and trucks",
"Other lodging away from home including hotels and motels",
"Lodging away from home",
"Public transportation")
),
size = 4,
nudge_x = 0.4,
nudge_y = 0.4)
ggsave(filename = "plot_cpi_US.pdf", width = 12, height = 6, units = "in")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_hist(aes(x = mm_apr21))
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21))
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21), bins = 50)
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21), bins = 100)
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21), bins = 100, fill = "steeblue")+
geom_histogram(aes(x = mm_apr21), bins = 100, fill = "darkorange")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21), bins = 100, fill = "steelblue")+
geom_histogram(aes(x = mm_apr21), bins = 100, fill = "darkorange")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = mm_apr21), bins = 100, fill = "steelblue")+
geom_histogram(aes(x = weighted_mm_apr21), bins = 100, fill = "darkorange")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(id_cols = c(mm_apr21, weighted_mm_apr21), names_to = "variable", values_to = value) -> df_plot
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(id_cols = c(name, mm_apr21, weighted_mm_apr21), names_to = "variable", values_to = value) -> df_plot
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(names_to = "variable", values_to = "value") -> df_plot
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(cols = c(mm_apr21, weighted_apr21), names_to = "variable", values_to = "value") -> df_plot
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(cols = c("mm_apr21", "weighted_apr21"), names_to = "variable", values_to = "value") -> df_plot
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight) %>%
pivot_longer(cols = c("mm_apr21", "weighted_mm_apr21"), names_to = "variable", values_to = "value") -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = value), bins = 100, fill = "steelblue")+
facet_wrap(~variable, nrow = 2)
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight / 100) %>%
pivot_longer(cols = c("mm_apr21", "weighted_mm_apr21"), names_to = "variable", values_to = "value") -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = value), bins = 100, fill = "steelblue")+
facet_wrap(~variable, nrow = 2)
View(df_plot)
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(weighted_mm_apr21 = mm_apr21 * weight / 100) %>%
pivot_longer(cols = c("mm_apr21", "weighted_mm_apr21"), names_to = "variable", values_to = "value") -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = value), bins = 100, fill = "steelblue")+
facet_wrap(~variable, nrow = 2, scales = "free_x")
df %>%
filter(level %in% c(4, 5, 6, 7, 8), !(category %in% c("Energy", "Food"))) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(mm_apr21_weighted = mm_apr21 * weight / 100) %>%
pivot_longer(cols = c("mm_apr21", "mm_apr21_weighted"), names_to = "variable", values_to = "value") -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = value), bins = 100, fill = "steelblue")+
facet_wrap(~variable, nrow = 2, scales = "free_x")
df %>% group_by(level) %>% summarise(sum_weight = sum(weight))
df %>% filter(month == 2, year = 2020) %>% group_by(level) %>% summarise(sum_weight = sum(weight))
df %>% filter(month == 2, year == 2020) %>% group_by(level) %>% summarise(sum_weight = sum(weight))
df %>% filter(month == 2, year == 2020) %>% group_by(level) %>% summarise(sum_weight = sum(weight), count_series = n())
df %>%
filter(level == 3) %>%
group_by(name, weight, category) %>%
summarise(mm_apr21 = round(growth_rate(value, year, month, 2021, 3, 2021, 4), digits = 2)
) %>%
mutate(mm_apr21_weighted = mm_apr21 * weight / 100) %>%
pivot_longer(cols = c("mm_apr21", "mm_apr21_weighted"), names_to = "variable", values_to = "value") -> df_plot
ggplot(df_plot)+
geom_histogram(aes(x = value), bins = 100, fill = "steelblue")+
facet_wrap(~variable, nrow = 2, scales = "free_x")
df_plot
filter(df_plot, variable == "mm_apr21_weighted")
df_plot %>% filter(variable == "mm_apr21_weighted") %>% arrange(desc(value)) %>% head(10)
